import React, { useState, useMemo, useCallback } from 'react';
// Certifique-se de que esses caminhos de importa√ß√£o est√£o corretos em seu ambiente
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "./components/ui/card";
import { Button } from "./components/ui/button";
import { Progress } from "./components/ui/progress";

// Defini√ß√£o dos tipos para maior clareza e seguran√ßa (TypeScript)
interface Question {
  question: string;
  options: string[];
  correctAnswer: string;
  explanation: string;
}

interface QuestionsBySubject {
  [key: string]: Question[];
}

// O banco de perguntas fornecido pelo usu√°rio
const questionsBySubject: QuestionsBySubject = {
    logica: [
        {
            question: "Se todos os gatos s√£o animais e alguns animais s√£o pretos, podemos afirmar que:",
            options: [
                "Todos os gatos s√£o pretos",
                "Alguns gatos podem ser pretos",
                "Nenhum gato √© preto",
                "Todos os animais s√£o gatos"
            ],
            correctAnswer: "Alguns gatos podem ser pretos",
            explanation: "A conclus√£o v√°lida √© que alguns gatos podem ser pretos, pois a propriedade 'preto' aplica-se a alguns animais, e gatos s√£o animais."
        },
        {
            question: "Qual n√∫mero completa a sequ√™ncia: 2, 4, 8, 16, ___?",
            options: ["18", "20", "32", "24"],
            correctAnswer: "32",
            explanation: "A sequ√™ncia segue o padr√£o de multiplica√ß√£o por 2: 2√ó2=4, 4√ó2=8, 8√ó2=16, 16√ó2=32."
        },
        {
            question: "Se hoje √© segunda-feira, que dia ser√° daqui a 9 dias?",
            options: ["Ter√ßa-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira"],
            correctAnswer: "Quarta-feira",
            explanation: "9 dias depois de segunda-feira √© quarta-feira (segunda + 7 dias = segunda + 2 dias = quarta)."
        },
        {
            question: "Qual figura completa a sequ√™ncia: c√≠rculo, quadrado, tri√¢ngulo, c√≠rculo, quadrado, ___?",
            options: ["Tri√¢ngulo", "C√≠rculo", "Quadrado", "Ret√¢ngulo"],
            correctAnswer: "Tri√¢ngulo",
            explanation: "A sequ√™ncia se repete: c√≠rculo, quadrado, tri√¢ngulo."
        },
        {
            question: "Se A √© maior que B, e B √© maior que C, ent√£o:",
            options: ["A √© menor que C", "A √© maior que C", "B √© menor que A", "C √© maior que B"],
            correctAnswer: "A √© maior que C",
            explanation: "Se A > B e B > C, ent√£o A > C."
        },
        {
            question: "Qual √© o pr√≥ximo n√∫mero na sequ√™ncia: 1, 1, 2, 3, 5, 8, ___?",
            options: ["10", "11", "12", "13"],
            correctAnswer: "13",
            explanation: "Sequ√™ncia de Fibonacci: soma dos dois n√∫meros anteriores."
        },
        {
            question: "Se um trem viaja a 60 km/h, quanto tempo leva para percorrer 180 km?",
            options: ["2 horas", "3 horas", "4 horas", "5 horas"],
            correctAnswer: "3 horas",
            explanation: "Tempo = dist√¢ncia / velocidade = 180 / 60 = 3 horas."
        },
        {
            question: "Qual √© o valor l√≥gico da proposi√ß√£o: 'Se chove, ent√£o a rua est√° molhada', sabendo que est√° chovendo?",
            options: ["Verdadeiro", "Falso", "Indeterminado", "Nenhuma das anteriores"],
            correctAnswer: "Verdadeiro",
            explanation: "Se a condi√ß√£o √© verdadeira e a consequ√™ncia tamb√©m, a proposi√ß√£o √© verdadeira."
        },
        {
            question: "Qual √© o pr√≥ximo n√∫mero na sequ√™ncia: 5, 10, 20, 40, ___?",
            options: ["50", "60", "80", "100"],
            correctAnswer: "80",
            explanation: "Cada n√∫mero √© o dobro do anterior."
        },
        {
            question: "Se hoje √© quinta-feira, que dia ser√° daqui a 15 dias?",
            options: ["S√°bado", "Domingo", "Segunda-feira", "Ter√ßa-feira"],
            correctAnswer: "S√°bado",
            explanation: "15 dias depois de quinta-feira √© s√°bado (15 % 7 = 1, quinta + 1 dia = sexta, mas considerando o ciclo, √© s√°bado)."
        }
    ],
    portugues: [
        {
            question: "Qual a forma correta da frase?",
            options: [
                "Eu vou no mercado.",
                "Eu vou ao mercado.",
                "Eu vou na mercado.",
                "Eu vou para mercado."
            ],
            correctAnswer: "Eu vou ao mercado.",
            explanation: "A preposi√ß√£o 'a' contrai-se com o artigo 'o' formando 'ao', que √© a forma correta para indicar destino."
        },
        {
            question: "Qual a fun√ß√£o do sujeito na frase: 'O menino correu r√°pido'?",
            options: [
                "Indicar a a√ß√£o",
                "Indicar quem pratica a a√ß√£o",
                "Indicar o local",
                "Indicar o tempo"
            ],
            correctAnswer: "Indicar quem pratica a a√ß√£o",
            explanation: "O sujeito √© quem pratica a a√ß√£o do verbo."
        },
        {
            question: "Qual a forma correta do plural de 'cidad√£o'?",
            options: ["Cidad√£os", "Cidad√£es", "Cidad√£os", "Cidad√£es"],
            correctAnswer: "Cidad√£os",
            explanation: "O plural de 'cidad√£o' √© 'cidad√£os'."
        },
        {
            question: "Qual a classe gramatical da palavra 'r√°pido' na frase 'Ele corre r√°pido'?",
            options: ["Substantivo", "Adjetivo", "Adv√©rbio", "Verbo"],
            correctAnswer: "Adv√©rbio",
            explanation: "'R√°pido' modifica o verbo 'corre', funcionando como adv√©rbio."
        },
        {
            question: "Qual a forma correta: 'Mau' ou 'Mal'?",
            options: [
                "'Mau' √© o oposto de bom; 'Mal' √© o oposto de bem",
                "'Mau' √© o oposto de bem; 'Mal' √© o oposto de bom",
                "Ambos significam a mesma coisa",
                "Nenhuma das anteriores"
            ],
            correctAnswer: "'Mau' √© o oposto de bom; 'Mal' √© o oposto de bem",
            explanation: "'Mau' √© adjetivo, 'Mal' √© adv√©rbio."
        },
        {
            question: "Qual a forma correta da frase?",
            options: [
                "Ela viu o filme ontem.",
                "Ela viu o filme ontem.",
                "Ela viu o filme ontem.",
                "Ela viu o filme ontem."
            ],
            correctAnswer: "Ela viu o filme ontem.",
            explanation: "Frase correta com verbo no passado."
        },
        {
            question: "Qual a forma correta do verbo no presente do indicativo: 'N√≥s ___ ao parque'?",
            options: ["vamos", "v√£o", "vai", "vou"],
            correctAnswer: "vamos",
            explanation: "'N√≥s' exige a forma 'vamos'."
        },
        {
            question: "Qual a forma correta: 'A gente' ou 'A gente √©'?",
            options: ["A gente √©", "A gente s√£o", "A gente est√°", "A gente est√£o"],
            correctAnswer: "A gente √©",
            explanation: "'A gente' √© singular e exige verbo no singular."
        },
        {
            question: "Qual a forma correta: 'Houveram problemas' ou 'Houve problemas'?",
            options: ["Houve problemas", "Houveram problemas", "Houve problema", "Houveram problema"],
            correctAnswer: "Houve problemas",
            explanation: "'Houve' √© verbo impessoal e n√£o varia no plural."
        },
        {
            question: "Qual a forma correta: 'Mais' ou 'Mas'?",
            options: [
                "'Mais' indica adi√ß√£o; 'Mas' indica contraste",
                "'Mais' indica contraste; 'Mas' indica adi√ß√£o",
                "Ambos significam a mesma coisa",
                "Nenhuma das anteriores"
            ],
            correctAnswer: "'Mais' indica adi√ß√£o; 'Mas' indica contraste",
            explanation: "'Mais' √© adv√©rbio de intensidade; 'Mas' √© conjun√ß√£o adversativa."
        }
    ],
    informatica: [
        {
            question: "O que significa a sigla 'CPU'?",
            options: [
                "Central Processing Unit",
                "Computer Personal Unit",
                "Central Program Unit",
                "Computer Processing Unit"
            ],
            correctAnswer: "Central Processing Unit",
            explanation: "CPU significa Central Processing Unit, ou Unidade Central de Processamento em portugu√™s."
        },
        {
            question: "Qual programa √© usado para editar textos?",
            options: [
                "Navegador",
                "Editor de texto",
                "Planilha eletr√¥nica",
                "Antiv√≠rus"
            ],
            correctAnswer: "Editor de texto",
            explanation: "Editor de texto √© usado para criar e editar documentos de texto."
        },
        {
            question: "O que √© um sistema operacional?",
            options: [
                "Um programa para editar imagens",
                "Um software que gerencia hardware e recursos do computador",
                "Um tipo de v√≠rus",
                "Um navegador de internet"
            ],
            correctAnswer: "Um software que gerencia hardware e recursos do computador",
            explanation: "Sistema operacional √© o software principal que controla o computador."
        },
        {
            question: "Qual dispositivo √© usado para entrada de dados?",
            options: [
                "Monitor",
                "Teclado",
                "Impressora",
                "Alto-falante"
            ],
            correctAnswer: "Teclado",
            explanation: "Teclado √© um dispositivo de entrada para digitar dados."
        },
        {
            question: "O que √© um navegador de internet?",
            options: [
                "Um programa para acessar p√°ginas web",
                "Um programa para editar v√≠deos",
                "Um tipo de hardware",
                "Um sistema operacional"
            ],
            correctAnswer: "Um programa para acessar p√°ginas web",
            explanation: "Navegador permite acessar e visualizar sites na internet."
        }
    ],
    rondonia: [
        {
            question: "Qual √© a capital do estado de Rond√¥nia?",
            options: ["Porto Velho", "Ji-Paran√°", "Ariquemes", "Vilhena"],
            correctAnswer: "Porto Velho",
            explanation: "Porto Velho √© a capital e maior cidade do estado de Rond√¥nia."
        },
        {
            question: "Rond√¥nia faz fronteira com qual pa√≠s?",
            options: ["Argentina", "Bol√≠via", "Peru", "Paraguai"],
            correctAnswer: "Bol√≠via",
            explanation: "Rond√¥nia faz fronteira com a Bol√≠via ao sul."
        },
        {
            question: "Qual √© o principal bioma de Rond√¥nia?",
            options: ["Caatinga", "Mata Atl√¢ntica", "Amaz√¥nia", "Pampa"],
            correctAnswer: "Amaz√¥nia",
            explanation: "Rond√¥nia est√° localizado na regi√£o da Amaz√¥nia."
        },
        {
            question: "Qual rio √© importante para Rond√¥nia?",
            options: ["Rio S√£o Francisco", "Rio Madeira", "Rio Paran√°", "Rio Tiet√™"],
            correctAnswer: "Rio Madeira",
            explanation: "O Rio Madeira √© um dos principais rios que cortam Rond√¥nia."
        },
        {
            question: "Em que ano Rond√¥nia foi elevado √† categoria de estado?",
            options: ["1981", "1979", "1985", "1990"],
            correctAnswer: "1981",
            explanation: "Rond√¥nia tornou-se estado da federa√ß√£o em 1981."
        }
    ],
    legislacao: [
        {
            question: "Qual √© a fun√ß√£o principal da Constitui√ß√£o Federal?",
            options: [
                "Criar leis municipais",
                "Estabelecer os direitos e deveres dos cidad√£os",
                "Organizar festas p√∫blicas",
                "Definir o calend√°rio escolar"
            ],
            correctAnswer: "Estabelecer os direitos e deveres dos cidad√£os",
            explanation: "A Constitui√ß√£o Federal √© a lei fundamental que estabelece a organiza√ß√£o do Estado e os direitos e deveres dos cidad√£os."
        },
        {
            question: "O que √© um decreto?",
            options: [
                "Uma lei aprovada pelo Congresso",
                "Uma norma emitida pelo Poder Executivo",
                "Uma decis√£o judicial",
                "Um projeto de lei"
            ],
            correctAnswer: "Uma norma emitida pelo Poder Executivo",
            explanation: "Decreto √© uma norma jur√≠dica expedida pelo Poder Executivo."
        },
        {
            question: "Qual o √≥rg√£o respons√°vel por criar leis federais no Brasil?",
            options: [
                "Poder Executivo",
                "Poder Judici√°rio",
                "Congresso Nacional",
                "Tribunal de Contas"
            ],
            correctAnswer: "Congresso Nacional",
            explanation: "O Congresso Nacional √© respons√°vel pela elabora√ß√£o das leis federais."
        },
        {
            question: "O que √© um direito fundamental?",
            options: [
                "Direito que pode ser retirado a qualquer momento",
                "Direito b√°sico garantido a todos os cidad√£os",
                "Direito exclusivo do governo",
                "Direito que n√£o est√° na Constitui√ß√£o"
            ],
            correctAnswer: "Direito b√°sico garantido a todos os cidad√£os",
            explanation: "Direitos fundamentais s√£o garantias b√°sicas previstas na Constitui√ß√£o."
        },
        {
            question: "Qual √© a fun√ß√£o do Poder Judici√°rio?",
            options: [
                "Criar leis",
                "Executar leis",
                "Interpretar e aplicar as leis",
                "Fiscalizar contas p√∫blicas"
            ],
            correctAnswer: "Interpretar e aplicar as leis",
            explanation: "O Judici√°rio interpreta e aplica as leis nos casos concretos."
        }
    ],
    administrativo: [
        {
            question: "O que √© planejamento estrat√©gico?",
            options: [
                "Definir metas e objetivos para o futuro da organiza√ß√£o",
                "Controlar as finan√ßas da empresa",
                "Contratar funcion√°rios",
                "Organizar eventos"
            ],
            correctAnswer: "Definir metas e objetivos para o futuro da organiza√ß√£o",
            explanation: "Planejamento estrat√©gico √© o processo de definir a dire√ß√£o de uma organiza√ß√£o atrav√©s da aloca√ß√£o de recursos e defini√ß√£o de metas."
        },
        {
            question: "Qual a fun√ß√£o do setor de recursos humanos?",
            options: [
                "Gerenciar o estoque",
                "Cuidar da contrata√ß√£o e desenvolvimento dos colaboradores",
                "Realizar vendas",
                "Controlar a produ√ß√£o"
            ],
            correctAnswer: "Cuidar da contrata√ß√£o e desenvolvimento dos colaboradores",
            explanation: "Recursos humanos gerencia pessoas e processos relacionados."
        },
        {
            question: "O que √© organograma?",
            options: [
                "Documento financeiro",
                "Representa√ß√£o gr√°fica da estrutura organizacional",
                "Plano de marketing",
                "Relat√≥rio de vendas"
            ],
            correctAnswer: "Representa√ß√£o gr√°fica da estrutura organizacional",
            explanation: "Organograma mostra a hierarquia e rela√ß√µes na empresa."
        },
        {
            question: "Qual a principal fun√ß√£o da contabilidade?",
            options: [
                "Gerenciar pessoas",
                "Registrar e controlar as finan√ßas",
                "Planejar eventos",
                "Fazer vendas"
            ],
            correctAnswer: "Registrar e controlar as finan√ßas",
            explanation: "Contabilidade cuida das finan√ßas e registros econ√¥micos."
        },
        {
            question: "O que √© lideran√ßa?",
            options: [
                "Capacidade de influenciar e motivar pessoas",
                "Controle financeiro",
                "Organiza√ß√£o de documentos",
                "Venda de produtos"
            ],
            correctAnswer: "Capacidade de influenciar e motivar pessoas",
            explanation: "Lideran√ßa √© a habilidade de guiar equipes."
        },
        // Quest√µes adicionais para completar 10
        {
            question: "Qual a import√¢ncia da comunica√ß√£o interna na empresa?",
            options: [
                "Melhorar o relacionamento e efici√™ncia",
                "Aumentar vendas externas",
                "Reduzir custos de produ√ß√£o",
                "Controlar estoque"
            ],
            correctAnswer: "Melhorar o relacionamento e efici√™ncia",
            explanation: "Comunica√ß√£o interna eficaz melhora o ambiente e resultados."
        },
        {
            question: "O que √© benchmarking?",
            options: [
                "An√°lise da concorr√™ncia para melhorar processos",
                "Planejamento financeiro",
                "Treinamento de funcion√°rios",
                "Controle de qualidade"
            ],
            correctAnswer: "An√°lise da concorr√™ncia para melhorar processos",
            explanation: "Benchmarking √© comparar pr√°ticas para aprimorar a empresa."
        },
        {
            question: "Qual a fun√ß√£o do setor de compras?",
            options: [
                "Vender produtos",
                "Adquirir materiais e servi√ßos necess√°rios",
                "Gerenciar pessoas",
                "Controlar finan√ßas"
            ],
            correctAnswer: "Adquirir materiais e servi√ßos necess√°rios",
            explanation: "Compras garantem insumos para a opera√ß√£o."
        },
        {
            question: "O que √© miss√£o de uma empresa?",
            options: [
                "Objetivo financeiro",
                "Raz√£o de existir e prop√≥sito da empresa",
                "Plano de marketing",
                "Estrutura organizacional"
            ],
            correctAnswer: "Raz√£o de existir e prop√≥sito da empresa",
            explanation: "Miss√£o define o prop√≥sito e valores da empresa."
        },
        {
            question: "Qual a import√¢ncia do controle de qualidade?",
            options: [
                "Garantir produtos e servi√ßos dentro dos padr√µes",
                "Aumentar o n√∫mero de funcion√°rios",
                "Definir a cor do logotipo",
                "Contratar novos fornecedores"
            ],
            correctAnswer: "Garantir produtos e servi√ßos dentro dos padr√µes",
            explanation: "Controle de qualidade visa a excel√™ncia e conformidade do que √© entregue."
        }
    ],
};

// Mapeamento para nomes de exibi√ß√£o mais amig√°veis
const subjectDisplayNames: { [key: string]: string } = {
  logica: "Racioc√≠nio L√≥gico",
  portugues: "L√≠ngua Portuguesa",
  informatica: "Inform√°tica B√°sica",
  rondonia: "Hist√≥ria e Geografia de Rond√¥nia",
  legislacao: "No√ß√µes de Legisla√ß√£o",
  administrativo: "No√ß√µes de Administra√ß√£o",
};

const QuizGame = () => {
  // Estados que voc√™ j√° definiu
  const [currentSubject, setCurrentSubject] = useState<string>('');
  const [currentQuestionIndex, setCurrentQuestionIndex] = useState<number>(0);
  const [score, setScore] = useState<number>(0);
  const [gameStatus, setGameStatus] = useState<'menu' | 'playing' | 'finished'>('menu');
  const [selectedAnswer, setSelectedAnswer] = useState<string | null>(null);
  const [showExplanation, setShowExplanation] = useState<boolean>(false);

  // Memoiza√ß√£o para evitar rec√°lculos desnecess√°rios
  const questions = useMemo(() => currentSubject ? questionsBySubject[currentSubject] : [], [currentSubject]);
  const totalQuestions = questions.length;
  const currentQuestion = questions[currentQuestionIndex];
  const progressValue = totalQuestions > 0 ? ((currentQuestionIndex) / totalQuestions) * 100 : 0;

  // L√≥gica de manipula√ß√£o de a√ß√µes
  const startGame = useCallback((subject: string) => {
    setCurrentSubject(subject);
    setCurrentQuestionIndex(0);
    setScore(0);
    setSelectedAnswer(null);
    setShowExplanation(false);
    setGameStatus('playing');
  }, []);

  const handleAnswerSelect = (answer: string) => {
    if (!selectedAnswer) { // Permite selecionar apenas se ainda n√£o houver uma resposta selecionada
      setSelectedAnswer(answer);
      const isCorrect = answer === currentQuestion.correctAnswer;
      if (isCorrect) {
        setScore(prevScore => prevScore + 1);
      }
      setShowExplanation(true);
    }
  };

  const nextQuestion = () => {
    // Se ainda houver perguntas, avan√ßa
    if (currentQuestionIndex < totalQuestions - 1) {
      setCurrentQuestionIndex(prevIndex => prevIndex + 1);
      setSelectedAnswer(null);
      setShowExplanation(false);
    } else {
      // Se for a √∫ltima pergunta, finaliza o jogo
      setGameStatus('finished');
    }
  };

  const restartGame = () => {
    setGameStatus('menu');
    setCurrentSubject('');
    setCurrentQuestionIndex(0);
    setScore(0);
    setSelectedAnswer(null);
    setShowExplanation(false);
  };

  // --- Renderiza√ß√£o de Componentes ---

  // 1. Menu Inicial
  const renderMenu = () => (
    <Card className="w-full max-w-lg mx-auto">
      <CardHeader>
        <CardTitle className="text-2xl font-bold">Quiz de Conhecimentos</CardTitle>
        <CardDescription>Selecione um assunto para come√ßar o desafio!</CardDescription>
      </CardHeader>
      <CardContent className="space-y-4">
        {Object.keys(questionsBySubject).map((subjectKey) => (
          <Button
            key={subjectKey}
            className="w-full justify-start text-left h-auto py-3"
            onClick={() => startGame(subjectKey)}
            variant="outline"
          >
            {subjectDisplayNames[subjectKey]} ({questionsBySubject[subjectKey].length} quest√µes)
          </Button>
        ))}
      </CardContent>
    </Card>
  );

  // 2. Tela de Jogo
  const renderPlaying = () => {
    if (!currentQuestion) return null; // Garante que a pergunta existe

    const isAnswered = selectedAnswer !== null;

    const getButtonClass = (option: string) => {
      if (!isAnswered) {
        return "bg-gray-100 hover:bg-gray-200"; // Cor normal antes de responder
      }
      if (option === currentQuestion.correctAnswer) {
        return "bg-green-500 hover:bg-green-600 text-white"; // Resposta correta
      }
      if (option === selectedAnswer) {
        return "bg-red-500 hover:bg-red-600 text-white"; // Resposta incorreta selecionada
      }
      return "bg-gray-100 opacity-50"; // Op√ß√µes n√£o selecionadas
    };

    return (
      <Card className="w-full max-w-2xl mx-auto">
        <CardHeader>
          <div className="flex justify-between items-center mb-3">
            <CardTitle>{subjectDisplayNames[currentSubject]}</CardTitle>
            <span className="text-lg font-semibold text-blue-600">
              {currentQuestionIndex + 1} / {totalQuestions}
            </span>
          </div>
          <Progress value={progressValue} className="h-2" />
          <CardDescription className="mt-4 text-lg font-medium text-gray-800">
            {currentQuestion.question}
          </CardDescription>
        </CardHeader>

        <CardContent className="space-y-3">
          {/* Op√ß√µes de Resposta */}
          {currentQuestion.options.map((option, index) => (
            <Button
              key={index}
              className={`w-full h-auto py-3 text-left justify-start whitespace-normal transition-colors duration-300 ${getButtonClass(option)}`}
              onClick={() => handleAnswerSelect(option)}
              disabled={isAnswered}
              variant="outline"
            >
              {option}
            </Button>
          ))}

          {/* Feedback e Explica√ß√£o */}
          {showExplanation && (
            <div className={`p-4 mt-4 rounded-lg transition-all duration-500 ease-in-out ${selectedAnswer === currentQuestion.correctAnswer ? 'bg-green-100 border-green-400' : 'bg-red-100 border-red-400'} border-l-4`}>
              <p className="font-bold">
                {selectedAnswer === currentQuestion.correctAnswer ? "Correto! üéâ" : "Incorreto. ‚ùå"}
              </p>
              <p className="text-sm mt-1">
                **Resposta Correta:** {currentQuestion.correctAnswer}
              </p>
              <p className="text-sm mt-2 font-medium italic">
                {currentQuestion.explanation}
              </p>
            </div>
          )}

          {/* Bot√£o de Pr√≥xima Quest√£o */}
          {isAnswered && (
            <Button
              className="w-full mt-6"
              onClick={nextQuestion}
            >
              {currentQuestionIndex < totalQuestions - 1 ? "Pr√≥xima Quest√£o" : "Finalizar Quiz"}
            </Button>
          )}
        </CardContent>
      </Card>
    );
  };

  // 3. Tela Final
  const renderFinished = () => {
    const percentage = totalQuestions > 0 ? Math.round((score / totalQuestions) * 100) : 0;
    let feedbackMessage = "";

    if (percentage === 100) {
      feedbackMessage = "Parab√©ns, pontua√ß√£o m√°xima! Voc√™ √© um expert! üèÜ";
    } else if (percentage >= 70) {
      feedbackMessage = "Excelente resultado! Quase l√°! ‚ú®";
    } else if (percentage >= 50) {
      feedbackMessage = "Bom trabalho! Continue estudando para melhorar. üëç";
    } else {
      feedbackMessage = "Voc√™ pode fazer melhor. Revise o material e tente novamente! üìö";
    }

    return (
      <Card className="w-full max-w-lg mx-auto text-center">
        <CardHeader>
          <CardTitle className="text-3xl font-bold text-blue-700">Quiz Finalizado!</CardTitle>
          <CardDescription className="text-lg">Resultado em {subjectDisplayNames[currentSubject]}</CardDescription>
        </CardHeader>
        <CardContent className="space-y-6">
          <div className="text-4xl font-extrabold text-gray-800">
            {score} / {totalQuestions}
          </div>
          <Progress value={percentage} className="h-3" />
          <p className="text-xl font-semibold text-gray-700">
            {percentage}% de acerto
          </p>
          <p className="text-md italic text-gray-600">
            {feedbackMessage}
          </p>
          <Button
            className="w-full mt-4"
            onClick={restartGame}
          >
            Voltar ao Menu
          </Button>
        </CardContent>
      </Card>
    );
  };

  // Renderiza√ß√£o principal baseada no estado do jogo
  return (
    <div className="flex items-center justify-center min-h-screen p-4 bg-gray-50">
      {gameStatus === 'menu' && renderMenu()}
      {gameStatus === 'playing' && renderPlaying()}
      {gameStatus === 'finished' && renderFinished()}
    </div>
  );
};

export default QuizGame;
